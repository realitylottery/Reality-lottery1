<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile - RealityLottery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
    body {background:#000;color:#fff;min-height:100vh;display:flex;flex-direction:column;}
    header {padding:20px;background:#111;border-bottom:2px solid #ffd700;}
    .logo {font-size:28px;font-weight:bold;color:#ffd700;}
    .content {flex:1;padding:20px;max-width:600px;margin:auto;text-align:left;}
    h2 {color:#ffd700;margin-bottom:15px;}
    .task {padding:10px;margin:8px 0;border-radius:6px;background:#111;}
    .done {color:#0f0;}
    footer {position:fixed;bottom:0;left:0;right:0;background:#111;border-top:2px solid #ffd700;
      padding:10px 0;display:flex;justify-content:space-around;align-items:center;}
    footer a {color:#ffd700;text-decoration:none;font-size:14px;font-weight:bold;display:flex;flex-direction:column;align-items:center;}
    footer a i {font-size:18px;margin-bottom:4px;}
    footer a:hover {color:#ffa500;}
  </style>
</head>
<body>
<header>
  <div class="logo">Profile</div>
</header>

<section class="content">
  <h2>User Info</h2>
  <p><strong>Username:</strong> <span id="username">-</span></p>
  <p><strong>Email:</strong> <span id="email">-</span></p>
  <p><strong>Subscription:</strong> <span id="subscription">-</span></p>

  <h2>Tasks Progress</h2>
  <div id="tasks"></div>
</section>

<footer>
  <a href="index.html"><i class="fas fa-home"></i>Home</a>
  <a href="news.html"><i class="fas fa-newspaper"></i>News</a>
  <a href="withdrawal.html"><i class="fas fa-wallet"></i>Withdrawal</a>
  <a href="profile.html"><i class="fas fa-user"></i>Profile</a>
</footer>

<script>
const API_BASE = "https://realitylottery.koyeb.app";
const token = localStorage.getItem("rl_token");

async function loadProfile(){
  if(!token){alert("Login required");return;}
  const res = await fetch(API_BASE+"/api/auth/me",{headers:{"Authorization":"Bearer "+token}});
  const data = await res.json();
  if(!data.user) return;

  document.getElementById("username").textContent = data.user.username;
  document.getElementById("email").textContent = data.user.email;
  document.getElementById("subscription").textContent = data.user.subscription || "None";

  // simulate 6-step mission progress
  const progress = data.user.taskProgress || 1; // step number
  const tasksDiv = document.getElementById("tasks");
  tasksDiv.innerHTML="";
  for(let i=1;i<=6;i++){
    const div=document.createElement("div");
    div.className="task";
    div.innerHTML=`Step ${i}: ${i<=progress?'<span class="done">âœ” Completed</span>':'Pending'}`;
    tasksDiv.appendChild(div);
  }
}
loadProfile();
</script>
</body>
</html>
